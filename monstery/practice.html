<script>
// ===================== DATASET =====================
const monasteryData = {
  rumtek: {
    id:'rumtek',
    title:'Rumtek Monastery',
    images:[
      'img/Rumtek1.jpeg.jpg',
      'img/Rumtek2.jpeg.jpg'
    ],
    video:'https://www.youtube.com/embed/afh5du83c78',
    history:'Rumtek Monastery (also called Dharmachakra Centre) is one of the largest monasteries in Sikkim.',
    visiting:'Best time: Morning; Entry: Free'
  },
  pemayangtse: {
    id:'pemayangtse',
    title:'Pemayangtse Monastery',
    images:[
      'img/Pemayangtse1.jpg',
      'img/Pemayangtse2.jpg'
    ],
    video:'https://www.youtube.com/embed/xxxxxx',
    history:'Pemayangtse is one of the oldest monasteries in Sikkim.',
    visiting:'Best time: Afternoon; Entry: ₹50'
  },
  enchey: {
    id:'enchey',
    title:'Enchey Monastery',
    images:[
      'img/Enchey1.jpg',
      'img/Enchey2.jpg'
    ],
    video:'https://www.youtube.com/embed/yyyyyy',
    history:'Enchey Monastery is located near Gangtok, known for its festivals.',
    visiting:'Best time: Morning & Evening; Entry: Free'
  }
};

// ===================== GLOBAL STATE =====================
let itinerary = [];

// ===================== ADD TO ITINERARY =====================
function addToItinerary(id){
  itinerary.push(id);   // store monastery id
  refreshItinerary();
  alert(`Added "${monasteryData[id].title}" to itinerary`);
}

// ===================== REFRESH ITINERARY DISPLAY =====================
function refreshItinerary(){
  const list = document.getElementById('itList');
  if(!list) return;

  if(itinerary.length === 0){
    list.innerHTML = '<div style="color:var(--muted);margin-top:12px">No items yet — add monasteries or choose a preset.</div>';
    return;
  }

  list.innerHTML = '';
  itinerary.forEach((id, idx) => {
    const m = monasteryData[id];
    if(!m) return;

    const div = document.createElement('div');
    div.className = 'it-item';
    div.innerHTML = `
      <div style="display:flex;align-items:center;gap:8px;cursor:pointer" onclick="openModal('${m.id}')">
        <img src="${m.images[0]}" style="width:50px;height:35px;object-fit:cover;border-radius:4px" 
             onerror="this.src='https://via.placeholder.com/50x35?text=No+Image'"/>
        <div>
          <strong>${m.title}</strong><br>
          <small style="color:var(--muted)">${m.visiting}</small>
        </div>
      </div>
      <div>
        <button onclick="removeIt(${idx})" style="border:0;background:transparent;color:var(--muted);cursor:pointer;font-size:16px">✕</button>
      </div>
    `;
    list.appendChild(div);
  });
}

// ===================== REMOVE ITEM =====================
function removeIt(idx){
  itinerary.splice(idx,1);
  refreshItinerary();
}

// ===================== PRINT ITINERARY =====================
function printItinerary(){
  if(itinerary.length === 0){ 
    alert('No items to print. Add monasteries to your itinerary first.'); 
    return; 
  }
  const printWindow = window.open('', '_blank', 'width=800,height=600');
  const html = `
    <html><head><title>Your Itinerary</title>
      <style>
        body{font-family:Arial;padding:20px}
        h1{color:#6f1515;}
        li{margin-bottom:12px}
        img{width:80px;height:60px;object-fit:cover;margin-right:8px;border-radius:6px;vertical-align:middle}
      </style>
    </head><body>
    <h1>Sikkim Monastery Itinerary</h1>
    <p>Generated: ${new Date().toLocaleString()}</p>
    <ul>
      ${itinerary.map(id=>{
        const m = monasteryData[id];
        return `<li>
          <img src="${m.images[0]}" onerror="this.src='https://via.placeholder.com/80x60?text=No+Image'"/> 
          <strong>${m.title}</strong><br>
          <small>${m.visiting}</small>
        </li>`;
      }).join('')}
    </ul>
    </body></html>
  `;
  printWindow.document.write(html); 
  printWindow.document.close(); 
  printWindow.focus(); 
  printWindow.print();
}

// ===================== CARD BUILDER (EXAMPLE) =====================
function buildCards(){
  const container = document.getElementById('cardContainer');
  container.innerHTML = '';
  Object.values(monasteryData).forEach(m=>{
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <h3>${m.title}</h3>
      <img src="${m.images[0]}" style="width:100%;height:150px;object-fit:cover;border-radius:6px" 
           onerror="this.src='https://via.placeholder.com/200x120?text=No+Image'"/>
      <p>${m.history}</p>
      <button onclick="openModal('${m.id}')">View Details</button>
      <button class="small-btn" onclick="addToItinerary('${m.id}')">Add to Itinerary</button>
    `;
    container.appendChild(card);
  });
}

// ===================== MODAL HANDLER =====================
function openModal(id){
  const data = monasteryData[id];
  if(!data) return;

  const modal = document.getElementById('modal');
  const modalContent = document.getElementById('modalContent');

  modalContent.innerHTML = `
    <h2>${data.title}</h2>
    <div style="display:flex;gap:8px;margin-bottom:10px">
      ${data.images.map(src=>`<img src="${src}" style="width:100px;height:70px;object-fit:cover;border-radius:4px"
        onerror="this.src='https://via.placeholder.com/100x70?text=No+Image'"/>`).join('')}
    </div>
    <iframe width="100%" height="200" src="${data.video}" frameborder="0" allowfullscreen></iframe>
    <p>${data.history}</p>
    <p><strong>Visiting Info:</strong> ${data.visiting}</p>
    <button class="small-btn" onclick="addToItinerary('${data.id}')">Add to Itinerary</button>
  `;

  modal.style.display = 'block';
}

function closeModal(){
  document.getElementById('modal').style.display = 'none';
}
</script>
